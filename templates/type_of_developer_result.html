<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
        const dd = {{developer_detailed_data|safe}};
  </script>
  <script>
        const di = {{developer_issues_data|safe}};
  </script>
  <div class="container">
    <div class="row">
      <div class="col">
        <img src="{{developer_basic_details["avatar_url"]}}" class="img-fluid rounded" alt="Responsive image">
      </div>

      <div class="col">
        <p class="fw-bold">{{developer_basic_details["name"]}}</p>
        <p class="fw-bold">{{developer_basic_details["bio"]}}</p>
        <p class="fw-bold">{{developer_basic_details["company"]}}</p>
        <p class="fw-bold">{{developer_basic_details["email"]}}</p>
        <p class="fw-bold">{{developer_basic_details["location"]}}</p>
      </div>
      
      <div class="col">
        <p class="fw-bold"><a href="https://github.com/{{developer_basic_details["login"]}}" class="link-primary">{{developer_basic_details["login"]}}</a></p>
        <p class="fw-bold">Profile created: {{developer_basic_details["created_at"]}}</p>
        <p class="fw-bold">Profile last updated: {{developer_basic_details["updated_at"]}}</p>
        <p class="fw-bold">Open for work: {{developer_basic_details["hireable"]}}</p>
      </div>

      <div class ="col">
        <p class="fw-bold">Is following {{developer_basic_details["following"]}} users</p>
        <p class="fw-bold">Is followed by {{developer_basic_details["followers"]}} users</p>
        <p class="fw-bold">Owns {{developer_basic_details["private_repos_owned"]}} private repos</p>
        <p class="fw-bold">Is member of {{developer_basic_details["team_count"]}} teams</p>
      </div>
    </div>
    <div class="row">
      <div class="col" id="programming_langs">
        List of programming languages and the sizes of changes made with them:
        <script type="text/javascript">
          const languages = dd["languages"];
          for (let i = 0; i < languages.length; i++){
            $("#programming_langs").append("<p>" + languages[i][0] + ": " + languages[i][1] + " additions \& deletions in recent commits</p>")
          }
       </script>
      </div>
      <div class="col" id="repos">
        List of 10 most recent repos user worked on (most recent comes first).
        <script type="text/javascript">
          const repos = dd["repos"];
           for (let i = 0; i < repos.length; i++) {
             $("#repos").append("<p><a href=\"https://github.com/" + repos[i] +"\">" + repos[i] + "</a></p>");
           }
        </script>
      </div>
      <div class="col">
        <p>Total commit count in the analysis period (most recent): {{developer_detailed_data["commit_count"]}} </p>
        <p>Median commit size in LoC: {{developer_detailed_data["median_diffbase_per_commit"]}}</p>
        <p>Median time between consequtive commits: {{developer_detailed_data["median_time_between_commits"]}} hours</p>
        <p>Average commit size in LoC: {{developer_detailed_data["average_change_size"]}}</p>
        <p>Average time between consequtive commits: {{developer_detailed_data["average_time_between_commits"]}} hours</p>
      </div>
    </div>
    <div class="row">
      <p class="text-center fw-bold">The below 2 distributions were cut at 90 percentile to remove outliers</p>
    </div>
    <div class="row">
      <div class="col">
        <canvas id="time_between_commits_dis"></canvas>
      </div>
      <div class="col">
        <canvas id="diffbase_dis"></canvas>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <p>User created {{developer_issues_data["issues_created"]}} issues</p>
        <p>User created {{developer_issues_data["pr_created"]}} pull requests</p>
        <p>User was assigned to {{developer_issues_data["issues_assigned"]}} issues</p>
        <p>User was assigned to {{developer_issues_data["pr_assigned"]}} pull requests</p>
      </div>
      <div class="col">
        <p>User closed {{developer_issues_data["issues_assigned_closed"]}}/{{developer_issues_data["issues_assigned"]}} issues assigned to them</p>
        <p>User closed {{developer_issues_data["pr_assigned_closed"]}}/{{developer_issues_data["pr_assigned"]}} pull requests assigned to them</p>
        <p>Average number of comments in issues created: {{developer_issues_data["avg_number_of_comments_in_created"]}}</p>
        <p>Average time to close issue: {{developer_issues_data["avg_time_to_close_issue"]}} hours</p>
        <p>Average time to close (review) PR: {{developer_issues_data["avg_time_to_review_pr"]}} hours</p>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <canvas id="time_between_is_c"></canvas>
      </div>
      <div class="col">
        <canvas id="time_between_is_a"></canvas>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <canvas id="time_between_pr_c"></canvas>
      </div>
      <div class="col">
        <canvas id="time_between_pr_a"></canvas>
      </div>
    </div>
  </div>



  <script>
    function create_bar_chart(id, labels, datapoints, title){
      const data = {
        labels: labels,
        datasets: [{
          label:  title,
          data: datapoints,
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(255, 159, 64, 0.2)',
            'rgba(255, 205, 86, 0.2)',
            'rgba(75, 192, 192, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(153, 102, 255, 0.2)',
            'rgba(201, 203, 207, 0.2)'
          ],
          borderColor: [
            'rgb(255, 99, 132)',
            'rgb(255, 159, 64)',
            'rgb(255, 205, 86)',
            'rgb(75, 192, 192)',
            'rgb(54, 162, 235)',
            'rgb(153, 102, 255)',
            'rgb(201, 203, 207)'
          ],
          borderWidth: 1
        }]
      };


      const config = {
          type: 'bar',
          data: data,
          options: {
            scales: {
              y: {
                beginAtZero: true
              }
            }
          },
      };
      
      const myChart = new Chart(
        document.getElementById(id),
        config
      );
    }
      
  </script>


<script>
  
   create_bar_chart("time_between_commits_dis", dd["time_between_commits"][1], dd["time_between_commits"][0], "Distribution of time between consequtive commits in hours.");
   create_bar_chart("diffbase_dis", dd["diffbase_per_commit"][1], dd["diffbase_per_commit"][0], "Distribution of diffbase per commit in LoC.");
   create_bar_chart("time_between_is_c", di["time_between_i_c"][1], di["time_between_i_c"][0], "Distribution of time between issues created");
   create_bar_chart("time_between_is_a", di["time_between_i_a"][1], di["time_between_i_a"][0], "Distribution of time between issues assigned");
   create_bar_chart("time_between_pr_c", di["time_between_pr_c"][1], di["time_between_pr_c"][0], "Distribution of time between PR created");
   create_bar_chart("time_between_pr_a", di["time_between_pr_a"][1], di["time_between_pr_a"][0], "Distribution of time between PR assigned");
</script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
